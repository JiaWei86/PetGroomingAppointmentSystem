@{
    ViewData["Title"] = "Pet Management";
    ViewData["ActivePage"] = "Pet";
}

<div class="content-header">
    <h1 class="page-title">Pet Management</h1>
</div>

<!-- Filters Section -->
<div class="panel">
    <h3 class="panel-title">Filter Pets</h3>
    
    <form method="get" class="form-grid filter-form">
        <div class="form-group">
            <label for="searchPetName">Pet Name</label>
            <input type="text" id="searchPetName" name="searchPetName" class="form-control" placeholder="Enter pet name" />
        </div>

        <div class="form-group">
            <label for="searchOwner">Owner Name</label>
            <input type="text" id="searchOwner" name="searchOwner" class="form-control" placeholder="Owner first or last name" />
        </div>

        <div class="form-group">
            <label for="searchPetType">Pet Type</label>
            <input type="text" id="searchPetType" name="searchPetType" class="form-control" placeholder="Dog, Cat, etc." />
        </div>

        <div class="form-group">
            <label>&nbsp;</label>
            <button type="submit" class="btn btn-primary">Filter</button>
            <button type="reset" class="btn btn-reset">Reset</button>
        </div>
    </form>
</div>

<!-- Pets Table -->
<div class="panel">
    @{
        // Hard-coded sample pet data
        var pets = new List<dynamic>
        {
            new { 
                Id = 1, 
                Name = "Buddy", 
                PetType = "Dog", 
                Breed = "Golden Retriever", 
                Age = 3, 
                Color = "Golden", 
                Weight = 30,
                Owner = "John Doe", 
                CreatedAt = DateTime.Parse("Jan 15, 2024"), 
                UpdatedAt = DateTime.Parse("Jan 20, 2024")
            },
            new { 
                Id = 2, 
                Name = "Whiskers", 
                PetType = "Cat", 
                Breed = "Siamese", 
                Age = 2, 
                Color = "Cream", 
                Weight = 4,
                Owner = "Sarah Johnson", 
                CreatedAt = DateTime.Parse("Feb 10, 2024"), 
                UpdatedAt = DateTime.Parse("Feb 18, 2024")
            },
            new { 
                Id = 3, 
                Name = "Max", 
                PetType = "Dog", 
                Breed = "German Shepherd", 
                Age = 5, 
                Color = "Brown", 
                Weight = 35,
                Owner = "John Doe", 
                CreatedAt = DateTime.Parse("Mar 05, 2024"), 
                UpdatedAt = DateTime.Parse("Mar 22, 2024")
            },
            new { 
                Id = 4, 
                Name = "Mittens", 
                PetType = "Cat", 
                Breed = "Persian", 
                Age = 4, 
                Color = "White", 
                Weight = 5,
                Owner = "Emily Davis", 
                CreatedAt = DateTime.Parse("Apr 12, 2024"), 
                UpdatedAt = DateTime.Parse("Apr 28, 2024")
            },
            new { 
                Id = 5, 
                Name = "Rex", 
                PetType = "Dog", 
                Breed = "Labrador", 
                Age = 6, 
                Color = "Black", 
                Weight = 32,
                Owner = "Michael Smith", 
                CreatedAt = DateTime.Parse("May 01, 2024"), 
                UpdatedAt = DateTime.Parse("May 15, 2024")
            }
        };
    }

    <div class="panel-header-wrapper">
        <h3 class="panel-title">Pets (@pets.Count)</h3>
        <button class="btn btn-primary" onclick="showCreateForm()">+ New Pet</button>
    </div>

    @if (pets.Count > 0)
    {
        <div class="table-responsive">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Pet Name</th>
                        <th>Owner</th>
                        <th>Type</th>
                        <th>Breed</th>
                        <th>Age</th>
                        <th>Color</th>
                        <th>Weight</th>
                        <th>Created</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var pet in pets)
                    {
                        <tr>
                            <td><strong>@pet.Name</strong></td>
                            <td>@pet.Owner</td>
                            <td>@pet.PetType</td>
                            <td>@pet.Breed</td>
                            <td>@pet.Age years</td>
                            <td>@pet.Color</td>
                            <td>@pet.Weight kg</td>
                            <td>@pet.CreatedAt.ToString("MMM dd, yyyy")</td>
                            <td>
                                <button class="btn btn-sm btn-info" onclick="showPetDetails(@pet.Id)">View</button>
                                <button class="btn btn-sm btn-action edit-btn" onclick="editPet(@pet.Id)">Edit</button>
                                <button class="btn btn-sm btn-action delete-btn" onclick="deletePet(@pet.Id)">Delete</button>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
    else
    {
        <div class="empty-state">
            <p>No pets found.</p>
        </div>
    }
</div>

<!-- View Pet Details Modal (Read-only) -->
<div id="petViewModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="petViewTitle">Pet Details</h2>
            <button class="close-btn" onclick="closePetViewModal()">&times;</button>
        </div>

        <div class="modal-body">
            <div class="details-grid">
                <div class="detail-row">
                    <span class="detail-label">Pet Name:</span>
                    <span class="detail-value" id="viewPetName"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Owner:</span>
                    <span class="detail-value" id="viewPetOwner"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Type:</span>
                    <span class="detail-value" id="viewPetType"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Breed:</span>
                    <span class="detail-value" id="viewPetBreed"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Age:</span>
                    <span class="detail-value" id="viewPetAge"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Color:</span>
                    <span class="detail-value" id="viewPetColor"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Weight:</span>
                    <span class="detail-value" id="viewPetWeight"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Created:</span>
                    <span class="detail-value" id="viewPetCreatedAt"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Updated:</span>
                    <span class="detail-value" id="viewPetUpdatedAt"></span>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closePetViewModal()">Close</button>
        </div>
    </div>
</div>

<!-- Create/Edit Pet Form -->
<div class="panel create-form" id="createPetForm">
    <h3 class="panel-title">Create New Pet</h3>

    <form asp-controller="Home" asp-action="CreatePet" method="post" class="form-grid">
        <div class="form-group">
            <label for="petName">Pet Name</label>
            <input type="text" id="petName" name="PetName" required />
        </div>

        <div class="form-group">
            <label for="owner">Owner Name</label>
            <input type="text" id="owner" name="Owner" required />
        </div>

        <div class="form-group">
            <label for="petType">Pet Type</label>
            <select id="petType" name="PetType" required>
                <option value="">Select Pet Type</option>
                <option value="Dog">Dog</option>
                <option value="Cat">Cat</option>
                <option value="Rabbit">Rabbit</option>
                <option value="Bird">Bird</option>
                <option value="Other">Other</option>
            </select>
        </div>

        <div class="form-group">
            <label for="breed">Breed</label>
            <input type="text" id="breed" name="Breed" required />
        </div>

        <div class="form-group">
            <label for="age">Age (years)</label>
            <input type="number" id="age" name="Age" min="0" required />
        </div>

        <div class="form-group">
            <label for="color">Color</label>
            <input type="text" id="color" name="Color" required />
        </div>

        <div class="form-group">
            <label for="weight">Weight (kg)</label>
            <input type="number" id="weight" name="Weight" min="0" step="0.1" required />
        </div>

        <div class="form-actions">
            <button type="button" class="btn btn-reset" onclick="hideCreateForm()">Cancel</button>
            <button type="submit" class="btn btn-success">Save Pet</button>
        </div>
    </form>
</div>

@section Scripts {
    <script>
        function showCreateForm() {
            document.getElementById('createPetForm').classList.add('visible');
            document.querySelector('html').style.overflow = 'hidden';
        }

        function hideCreateForm() {
            document.getElementById('createPetForm').classList.remove('visible');
            document.querySelector('html').style.overflow = 'auto';
        }

        function editPet(id) {
            alert('Edit functionality for pet #' + id + ' would go here');
            showCreateForm();
        }

        function deletePet(id) {
            if (confirm('Are you sure you want to delete this pet?')) {
                alert('Pet #' + id + ' deleted successfully');
                location.reload();
            }
        }

        document.addEventListener('click', function(event) {
            const form = document.getElementById('createPetForm');
            if (event.target === form) {
                hideCreateForm();
            }
        });
    </script>
}